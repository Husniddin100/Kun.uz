16 Feb 2024 - 10:59:22.359 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 20844 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 10:59:22.374 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 10:59:22.375 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 10:59:23.300 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 10:59:23.373 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 66 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 10:59:23.856 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 10:59:23.865 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 10:59:23.865 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 10:59:23.921 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 10:59:23.921 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1497 ms
16 Feb 2024 - 10:59:24.081 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 10:59:24.185 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 10:59:24.232 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 10:59:24.548 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 10:59:24.574 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 10:59:24.745 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@dd20ebc
16 Feb 2024 - 10:59:24.746 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 10:59:26.168 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 10:59:26.402 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 10:59:26.669 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 10:59:27.023 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 10:59:27.435 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 10:59:27.711 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2ce987d7, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@16a4d5a9, org.springframework.security.web.context.SecurityContextHolderFilter@e8acdfc, org.springframework.security.web.header.HeaderWriterFilter@22265a8d, org.springframework.security.web.authentication.logout.LogoutFilter@158566f8, com.example.config.JwtTokenFilter@4f67d628, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@ef64a8f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3a2cc282, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@427b24c0, org.springframework.security.web.access.ExceptionTranslationFilter@1eb21f22, org.springframework.security.web.access.intercept.AuthorizationFilter@1a89d045]
16 Feb 2024 - 10:59:27.992 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 10:59:28.001 INFO  com.example.Application - Started Application in 6.175 seconds (process running for 9.615)
16 Feb 2024 - 10:59:28.056 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 10:59:28.056 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 10:59:28.056 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 10:59:28.074 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 10:59:28.080 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 10:59:28.121 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.028s)
16 Feb 2024 - 10:59:28.130 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 10:59:28.143 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 10:59:28.180 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - likeTrigger" failed! Changes successfully rolled back.
16 Feb 2024 - 10:59:28.184 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 10:59:28.202 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42P01
Error Code : 0
Message    : ОШИБКА: отношение "video_like" не существует
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 43
Statement  : CREATE TRIGGER update_like
    AFTER UPDATE
    ON video_like
    FOR EACH ROW
    EXECUTE PROCEDURE like_update_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42P01
Error Code : 0
Message    : ОШИБКА: отношение "video_like" не существует
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 43
Statement  : CREATE TRIGGER update_like
    AFTER UPDATE
    ON video_like
    FOR EACH ROW
    EXECUTE PROCEDURE like_update_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: отношение "video_like" не существует
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 10:59:28.222 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 10:59:28.225 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 10:59:28.228 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:00:06.726 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 14948 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:00:06.735 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:00:06.735 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:00:07.462 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:00:07.521 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 53 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:00:07.932 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:00:07.939 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:00:07.940 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:00:07.986 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:00:07.987 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1215 ms
16 Feb 2024 - 11:00:08.090 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:00:08.141 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:00:08.180 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:00:08.441 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:00:08.459 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:00:08.582 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@182e4365
16 Feb 2024 - 11:00:08.583 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:00:09.686 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:00:09.867 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:00:10.098 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:00:10.426 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:00:10.819 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:00:11.113 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@28a210fb, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@8cc7489, org.springframework.security.web.context.SecurityContextHolderFilter@6fe2f6a0, org.springframework.security.web.header.HeaderWriterFilter@4b33b5b0, org.springframework.security.web.authentication.logout.LogoutFilter@3698f2ed, com.example.config.JwtTokenFilter@2975715, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2c9542eb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3be94b12, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7553ad52, org.springframework.security.web.access.ExceptionTranslationFilter@2b454886, org.springframework.security.web.access.intercept.AuthorizationFilter@76b17a78]
16 Feb 2024 - 11:00:11.553 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:00:11.563 INFO  com.example.Application - Started Application in 5.153 seconds (process running for 5.57)
16 Feb 2024 - 11:00:11.628 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:00:11.629 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:00:11.629 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:00:11.645 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:00:11.649 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:00:11.679 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.022s)
16 Feb 2024 - 11:00:11.689 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 11:00:11.699 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 11:00:11.718 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.011s)
16 Feb 2024 - 11:03:45.564 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:03:45.566 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 11:03:45.571 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:03:49.269 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 10748 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:03:49.279 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:03:49.279 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:03:49.992 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:03:50.052 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 55 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:03:50.517 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:03:50.525 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:03:50.525 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:03:50.579 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:03:50.579 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1267 ms
16 Feb 2024 - 11:03:50.673 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:03:50.773 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:03:50.829 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:03:51.071 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:03:51.092 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:03:51.221 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2520aa05
16 Feb 2024 - 11:03:51.222 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:03:52.554 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:03:52.786 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:03:53.044 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:03:53.316 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:03:53.708 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:03:54.006 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3396d2a6, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1ed43328, org.springframework.security.web.context.SecurityContextHolderFilter@32daccab, org.springframework.security.web.header.HeaderWriterFilter@76b93bb9, org.springframework.security.web.authentication.logout.LogoutFilter@bba6542, com.example.config.JwtTokenFilter@1912ba29, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4f34f451, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6c3a3d87, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@23216e17, org.springframework.security.web.access.ExceptionTranslationFilter@1752ab9b, org.springframework.security.web.access.intercept.AuthorizationFilter@45bf1ee3]
16 Feb 2024 - 11:03:54.454 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:03:54.464 INFO  com.example.Application - Started Application in 5.522 seconds (process running for 6.382)
16 Feb 2024 - 11:03:54.535 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:03:54.535 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:03:54.535 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:03:54.552 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:03:54.558 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:03:54.589 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.023s)
16 Feb 2024 - 11:03:54.601 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 5
16 Feb 2024 - 11:03:54.604 INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
16 Feb 2024 - 11:13:47.487 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:13:47.489 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 11:13:47.494 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:13:50.939 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 15400 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:13:50.947 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:13:50.948 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:13:51.590 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:13:51.644 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:13:52.043 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:13:52.050 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:13:52.050 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:13:52.101 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:13:52.102 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1122 ms
16 Feb 2024 - 11:13:52.177 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:13:52.212 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:13:52.233 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:13:52.405 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:13:52.423 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:13:52.540 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@175ac243
16 Feb 2024 - 11:13:52.541 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:13:53.466 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:13:53.602 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:13:53.763 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:13:54.037 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:13:54.446 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:13:54.703 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6a2cd5ea, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1c68601b, org.springframework.security.web.context.SecurityContextHolderFilter@59e7a6d8, org.springframework.security.web.header.HeaderWriterFilter@44bd11a2, org.springframework.security.web.authentication.logout.LogoutFilter@78f3ce56, com.example.config.JwtTokenFilter@67b5da40, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@69503026, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7959d16a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3128be29, org.springframework.security.web.access.ExceptionTranslationFilter@341f2f4c, org.springframework.security.web.access.intercept.AuthorizationFilter@6329d89f]
16 Feb 2024 - 11:13:54.961 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:13:54.968 INFO  com.example.Application - Started Application in 4.334 seconds (process running for 4.726)
16 Feb 2024 - 11:13:55.010 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:13:55.011 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:13:55.011 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:13:55.020 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:13:55.024 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:13:55.049 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 11:13:55.060 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration checksum mismatch for migration version 5
-> Applied to database : 1901660110
-> Resolved locally    : 1078496332
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 11:13:55.073 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:13:55.074 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 11:13:55.078 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:17:56.645 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 16840 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:17:56.654 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:17:56.654 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:17:57.305 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:17:57.358 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:17:57.814 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:17:57.822 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:17:57.823 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:17:57.878 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:17:57.880 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1189 ms
16 Feb 2024 - 11:17:57.964 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:17:58.013 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:17:58.038 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:17:58.230 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:17:58.247 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:17:58.371 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1073c664
16 Feb 2024 - 11:17:58.372 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:17:59.566 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:17:59.782 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:18:00.010 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:18:00.339 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:18:00.754 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:18:01.080 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@f6b85c3, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3d118651, org.springframework.security.web.context.SecurityContextHolderFilter@337fd6a1, org.springframework.security.web.header.HeaderWriterFilter@6b00587b, org.springframework.security.web.authentication.logout.LogoutFilter@1c68601b, com.example.config.JwtTokenFilter@39068df9, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@20c9b155, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@154f5d37, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@138a8c9e, org.springframework.security.web.access.ExceptionTranslationFilter@34dcd7a1, org.springframework.security.web.access.intercept.AuthorizationFilter@12b79055]
16 Feb 2024 - 11:18:01.448 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:18:01.456 INFO  com.example.Application - Started Application in 5.162 seconds (process running for 5.562)
16 Feb 2024 - 11:18:01.517 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:18:01.517 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:18:01.517 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:18:01.534 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:18:01.540 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:18:01.578 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 11:18:01.596 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration checksum mismatch for migration version 5
-> Applied to database : 1901660110
-> Resolved locally    : -1631154680
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 11:18:01.611 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:18:01.612 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 11:18:01.615 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:20:34.801 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 11472 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:20:34.810 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:20:34.810 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:20:35.447 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:20:35.503 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:20:35.902 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:20:35.908 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:20:35.909 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:20:35.954 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:20:35.955 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1111 ms
16 Feb 2024 - 11:20:36.034 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:20:36.069 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:20:36.090 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:20:36.263 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:20:36.282 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:20:36.400 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@152e7703
16 Feb 2024 - 11:20:36.401 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:20:37.309 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:20:37.442 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:20:37.596 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:20:37.867 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:20:38.242 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:20:38.469 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3467d540, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@67710b92, org.springframework.security.web.context.SecurityContextHolderFilter@154f5d37, org.springframework.security.web.header.HeaderWriterFilter@337fd6a1, org.springframework.security.web.authentication.logout.LogoutFilter@4da454a7, com.example.config.JwtTokenFilter@7d29fc6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2e7227e6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@43dc6864, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@56e32a23, org.springframework.security.web.access.ExceptionTranslationFilter@15ddf775, org.springframework.security.web.access.intercept.AuthorizationFilter@3d118651]
16 Feb 2024 - 11:20:38.740 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:20:38.749 INFO  com.example.Application - Started Application in 4.252 seconds (process running for 4.637)
16 Feb 2024 - 11:20:38.794 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:20:38.795 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:20:38.795 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:20:38.806 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:20:38.821 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:20:38.845 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.016s)
16 Feb 2024 - 11:20:38.853 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 11:20:38.873 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 11:20:38.896 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - likeTrigger" failed! Changes successfully rolled back.
16 Feb 2024 - 11:20:38.900 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 11:20:38.917 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42723
Error Code : 0
Message    : ОШИБКА: функция "increase_like_function" с аргументами таких типов уже существует
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 3
Statement  : -- INCREASE & DECREASE LIKE
-- AFTER CREATE
CREATE FUNCTION increase_like_function()
    RETURNS TRIGGER AS
    $$
BEGIN
UPDATE article
SET like_count = like_count + 1
WHERE id = NEW.article_id
  and NEW.status = 'LIKE';
RETURN NEW;
END;
$$

LANGUAGE 'plpgsql'

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42723
Error Code : 0
Message    : ОШИБКА: функция "increase_like_function" с аргументами таких типов уже существует
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 3
Statement  : -- INCREASE & DECREASE LIKE
-- AFTER CREATE
CREATE FUNCTION increase_like_function()
    RETURNS TRIGGER AS
    $$
BEGIN
UPDATE article
SET like_count = like_count + 1
WHERE id = NEW.article_id
  and NEW.status = 'LIKE';
RETURN NEW;
END;
$$

LANGUAGE 'plpgsql'

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: функция "increase_like_function" с аргументами таких типов уже существует
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 11:20:38.933 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:20:38.934 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 11:20:38.936 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 11:37:15.305 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 16280 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 11:37:15.314 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 11:37:15.315 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 11:37:15.975 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 11:37:16.031 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 11:37:16.435 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 11:37:16.442 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 11:37:16.443 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 11:37:16.486 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 11:37:16.487 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1138 ms
16 Feb 2024 - 11:37:16.562 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 11:37:16.597 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 11:37:16.617 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 11:37:16.789 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 11:37:16.806 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 11:37:16.934 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@182e4365
16 Feb 2024 - 11:37:16.936 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 11:37:17.839 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 11:37:17.975 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 11:37:18.125 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 11:37:18.395 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 11:37:18.767 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 11:37:19.013 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11caa21d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b0db8b1, org.springframework.security.web.context.SecurityContextHolderFilter@43dc6864, org.springframework.security.web.header.HeaderWriterFilter@154f5d37, org.springframework.security.web.authentication.logout.LogoutFilter@7d59e235, com.example.config.JwtTokenFilter@1da53092, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3698f2ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9eaaecf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@74cf0dd9, org.springframework.security.web.access.ExceptionTranslationFilter@5a558335, org.springframework.security.web.access.intercept.AuthorizationFilter@67710b92]
16 Feb 2024 - 11:37:19.282 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 11:37:19.291 INFO  com.example.Application - Started Application in 4.285 seconds (process running for 4.704)
16 Feb 2024 - 11:37:19.332 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 11:37:19.333 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 11:37:19.333 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 11:37:19.343 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 11:37:19.347 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 11:37:19.370 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 11:37:19.378 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 11:37:19.386 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 11:37:19.397 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.002s)
16 Feb 2024 - 12:25:20.764 WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=14m3s371ms185µs500ns).
16 Feb 2024 - 14:29:25.652 WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2h2m5s44ms140µs800ns).
16 Feb 2024 - 15:48:21.448 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 15:48:21.450 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 15:48:21.483 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 32 ms
16 Feb 2024 - 16:12:25.842 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:12:25.857 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:12:25.863 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:12:31.162 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 21128 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:12:31.173 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:12:31.174 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:12:31.820 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:12:31.875 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:12:32.279 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:12:32.286 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:12:32.286 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:12:32.333 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:12:32.334 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1128 ms
16 Feb 2024 - 16:12:32.410 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:12:32.444 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:12:32.466 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:12:32.638 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:12:32.656 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:12:32.786 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@70a24f9
16 Feb 2024 - 16:12:32.787 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:12:33.718 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:12:33.846 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:12:33.997 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:12:34.268 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:12:34.621 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:12:34.858 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7f83cc90, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3015fc1b, org.springframework.security.web.context.SecurityContextHolderFilter@5b1378cf, org.springframework.security.web.header.HeaderWriterFilter@664e8bb7, org.springframework.security.web.authentication.logout.LogoutFilter@793c2cde, com.example.config.JwtTokenFilter@20305c45, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@16adf66f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@64e41da0, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4db65fac, org.springframework.security.web.access.ExceptionTranslationFilter@370bd951, org.springframework.security.web.access.intercept.AuthorizationFilter@79009bde]
16 Feb 2024 - 16:12:35.118 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:12:35.126 INFO  com.example.Application - Started Application in 4.265 seconds (process running for 7.983)
16 Feb 2024 - 16:12:35.167 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:12:35.167 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:12:35.167 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:12:35.177 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:12:35.181 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:12:35.208 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:12:35.219 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration checksum mismatch for migration version 5
-> Applied to database : 323673503
-> Resolved locally    : 1011153901
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 16:12:35.235 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:12:35.236 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:12:35.243 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:15:57.562 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 19808 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:15:57.571 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:15:57.571 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:15:58.214 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:15:58.261 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:15:58.670 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:15:58.670 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:15:58.670 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:15:58.718 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:15:58.718 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1114 ms
16 Feb 2024 - 16:15:58.796 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:15:58.826 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:15:58.858 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:15:59.015 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:15:59.032 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:15:59.141 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38dbeb39
16 Feb 2024 - 16:15:59.141 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:16:00.084 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:16:00.214 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:16:00.366 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:16:00.642 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:16:01.024 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:16:01.276 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@569242a8, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5cc12274, org.springframework.security.web.context.SecurityContextHolderFilter@5f45b3f8, org.springframework.security.web.header.HeaderWriterFilter@4346ed39, org.springframework.security.web.authentication.logout.LogoutFilter@76b17a78, com.example.config.JwtTokenFilter@2975715, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@9b5ff2e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9d7d83d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@274d10aa, org.springframework.security.web.access.ExceptionTranslationFilter@2c9542eb, org.springframework.security.web.access.intercept.AuthorizationFilter@63031e98]
16 Feb 2024 - 16:16:01.532 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:16:01.545 INFO  com.example.Application - Started Application in 4.3 seconds (process running for 4.675)
16 Feb 2024 - 16:16:01.585 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:16:01.585 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:16:01.585 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:16:01.602 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:16:01.607 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:16:01.628 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.016s)
16 Feb 2024 - 16:16:01.635 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:16:01.644 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:16:01.652 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - likeTrigger" failed! Changes successfully rolled back.
16 Feb 2024 - 16:16:01.655 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:16:01.665 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 116
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 2
Statement  : -- Tetikleyici oluşturma
CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 116
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 2
Statement  : -- Tetikleyici oluşturma
CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 116
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 16:16:01.679 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:16:01.680 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:16:01.686 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:20:12.175 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 18488 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:20:12.185 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:20:12.185 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:20:12.866 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:20:12.928 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 58 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:20:13.398 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:20:13.414 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:20:13.414 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:20:13.455 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:20:13.455 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1237 ms
16 Feb 2024 - 16:20:13.536 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:20:13.568 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:20:13.593 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:20:13.764 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:20:13.788 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:20:13.910 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@43a59289
16 Feb 2024 - 16:20:13.910 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:20:14.896 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:20:15.041 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:20:15.204 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:20:15.511 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:20:15.909 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:20:16.180 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6a2cd5ea, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1c68601b, org.springframework.security.web.context.SecurityContextHolderFilter@59e7a6d8, org.springframework.security.web.header.HeaderWriterFilter@44bd11a2, org.springframework.security.web.authentication.logout.LogoutFilter@78f3ce56, com.example.config.JwtTokenFilter@31d327b6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@69503026, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7959d16a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3128be29, org.springframework.security.web.access.ExceptionTranslationFilter@341f2f4c, org.springframework.security.web.access.intercept.AuthorizationFilter@6329d89f]
16 Feb 2024 - 16:20:16.483 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:20:16.491 INFO  com.example.Application - Started Application in 4.658 seconds (process running for 5.028)
16 Feb 2024 - 16:20:16.533 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:20:16.533 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:20:16.537 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:20:16.545 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:20:16.550 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:20:16.575 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 16:20:16.581 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:20:16.592 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:20:16.599 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - likeTrigger" failed! Changes successfully rolled back.
16 Feb 2024 - 16:20:16.604 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:20:16.616 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 1
Statement  : CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 1
Statement  : CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 16:20:16.630 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:20:16.630 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:20:16.635 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:23:22.414 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 18124 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:23:22.422 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:23:22.423 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:23:23.087 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:23:23.146 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 53 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:23:23.562 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:23:23.572 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:23:23.572 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:23:23.617 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:23:23.618 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1161 ms
16 Feb 2024 - 16:23:23.697 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:23:23.732 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:23:23.756 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:23:23.943 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:23:23.961 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:23:24.116 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@789dd6bf
16 Feb 2024 - 16:23:24.118 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:23:25.106 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:23:25.241 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:23:25.426 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:23:25.764 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:23:26.167 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:23:26.460 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11caa21d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b0db8b1, org.springframework.security.web.context.SecurityContextHolderFilter@43dc6864, org.springframework.security.web.header.HeaderWriterFilter@154f5d37, org.springframework.security.web.authentication.logout.LogoutFilter@7d59e235, com.example.config.JwtTokenFilter@10f64bc3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3698f2ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9eaaecf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@74cf0dd9, org.springframework.security.web.access.ExceptionTranslationFilter@5a558335, org.springframework.security.web.access.intercept.AuthorizationFilter@67710b92]
16 Feb 2024 - 16:23:26.753 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:23:26.761 INFO  com.example.Application - Started Application in 4.668 seconds (process running for 5.076)
16 Feb 2024 - 16:23:26.805 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:23:26.806 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:23:26.806 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:23:26.817 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:23:26.822 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:23:26.852 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.023s)
16 Feb 2024 - 16:23:26.861 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:23:26.871 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:23:26.880 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - likeTrigger" failed! Changes successfully rolled back.
16 Feb 2024 - 16:23:26.887 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:23:26.898 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 1
Statement  : CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__likeTrigger.sql failed
------------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
Location   : db/migration/V5__likeTrigger.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__likeTrigger.sql)
Line       : 1
Statement  : CREATE TRIGGER increment_like_count
    AFTER INSERT ON article_like
    FOR EACH ROW
BEGIN
    
    UPDATE article
    SET like_count = like_count + 1
    WHERE id = NEW.article_id

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "BEGIN")
  Position: 90
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 16:23:26.913 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:23:26.915 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:23:26.920 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:26:50.193 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 7252 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:26:50.209 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:26:50.209 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:26:50.861 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:26:50.917 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:26:51.306 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:26:51.313 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:26:51.313 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:26:51.357 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:26:51.358 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1120 ms
16 Feb 2024 - 16:26:51.433 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:26:51.468 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:26:51.489 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:26:51.660 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:26:51.677 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:26:51.794 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@213012a0
16 Feb 2024 - 16:26:51.795 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:26:52.680 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:26:52.804 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:26:52.962 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:26:53.231 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:26:53.593 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:26:53.830 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6a2cd5ea, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1c68601b, org.springframework.security.web.context.SecurityContextHolderFilter@59e7a6d8, org.springframework.security.web.header.HeaderWriterFilter@44bd11a2, org.springframework.security.web.authentication.logout.LogoutFilter@78f3ce56, com.example.config.JwtTokenFilter@2a2cdba0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@69503026, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7959d16a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3128be29, org.springframework.security.web.access.ExceptionTranslationFilter@341f2f4c, org.springframework.security.web.access.intercept.AuthorizationFilter@6329d89f]
16 Feb 2024 - 16:26:54.098 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:26:54.106 INFO  com.example.Application - Started Application in 4.231 seconds (process running for 4.64)
16 Feb 2024 - 16:26:54.146 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:26:54.146 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:26:54.146 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:26:54.156 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:26:54.161 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:26:54.182 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.016s)
16 Feb 2024 - 16:26:54.190 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:26:54.197 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:26:54.217 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.014s)
16 Feb 2024 - 16:27:34.257 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 16:27:34.257 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 16:27:34.257 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
16 Feb 2024 - 16:27:59.517 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:27:59.577 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:27:59.581 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:28:03.066 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 15020 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:28:03.077 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:28:03.078 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:28:03.780 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:28:03.845 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 59 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:28:04.255 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:28:04.262 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:28:04.263 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:28:04.309 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:28:04.309 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1184 ms
16 Feb 2024 - 16:28:04.390 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:28:04.427 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:28:04.449 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:28:04.623 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:28:04.642 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:28:04.758 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@517a46f3
16 Feb 2024 - 16:28:04.759 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:28:05.707 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:28:05.844 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:28:05.991 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:28:06.272 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:28:06.683 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:28:06.949 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3d118651, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@138a8c9e, org.springframework.security.web.context.SecurityContextHolderFilter@5a558335, org.springframework.security.web.header.HeaderWriterFilter@15ddf775, org.springframework.security.web.authentication.logout.LogoutFilter@3128be29, com.example.config.JwtTokenFilter@39068df9, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@154f5d37, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@58c84be1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3467d540, org.springframework.security.web.access.ExceptionTranslationFilter@5c65001c, org.springframework.security.web.access.intercept.AuthorizationFilter@1cc771ae]
16 Feb 2024 - 16:28:07.214 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:28:07.220 INFO  com.example.Application - Started Application in 4.523 seconds (process running for 4.988)
16 Feb 2024 - 16:28:07.260 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:28:07.260 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:28:07.260 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:28:07.270 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:28:07.275 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:28:07.297 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.016s)
16 Feb 2024 - 16:28:07.304 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 5
16 Feb 2024 - 16:28:07.306 INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
16 Feb 2024 - 16:28:10.344 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 16:28:10.344 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 16:28:10.346 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
16 Feb 2024 - 16:28:10.438 INFO  c.e.controller.ArticleLikeController - Article like dc5d523a-d930-4408-a9ad-f473af147948
16 Feb 2024 - 16:28:10.535 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23503
16 Feb 2024 - 16:28:10.535 ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ОШИБКА: INSERT или UPDATE в таблице "article_like" нарушает ограничение внешнего ключа "fkabthli6g1qjriusniw93pbesw"
  Detail: Ключ (article_id)=(dc5d523a-d930-4408-a9ad-f473af147948) отсутствует в таблице "article".
16 Feb 2024 - 16:28:10.541 ERROR c.e.c.ExeptionHandlerController - could not execute statement [ОШИБКА: INSERT или UPDATE в таблице "article_like" нарушает ограничение внешнего ключа "fkabthli6g1qjriusniw93pbesw"
  Detail: Ключ (article_id)=(dc5d523a-d930-4408-a9ad-f473af147948) отсутствует в таблице "article".] [insert into article_like (article_id,created_date,profile_id,status) values (?,?,?,?)]; SQL [insert into article_like (article_id,created_date,profile_id,status) values (?,?,?,?)]; constraint [null]
16 Feb 2024 - 16:28:38.190 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:28:38.195 WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23503
16 Feb 2024 - 16:28:38.195 ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ОШИБКА: INSERT или UPDATE в таблице "article_like" нарушает ограничение внешнего ключа "fk3nh5v0y6puji3a1pihsw8a1ce"
  Detail: Ключ (profile_id)=(3) отсутствует в таблице "profile".
16 Feb 2024 - 16:28:38.196 ERROR c.e.c.ExeptionHandlerController - could not execute statement [ОШИБКА: INSERT или UPDATE в таблице "article_like" нарушает ограничение внешнего ключа "fk3nh5v0y6puji3a1pihsw8a1ce"
  Detail: Ключ (profile_id)=(3) отсутствует в таблице "profile".] [insert into article_like (article_id,created_date,profile_id,status) values (?,?,?,?)]; SQL [insert into article_like (article_id,created_date,profile_id,status) values (?,?,?,?)]; constraint [null]
16 Feb 2024 - 16:28:42.704 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:33:14.595 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:33:14.598 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:33:14.600 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:33:16.515 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 18080 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:33:16.523 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:33:16.524 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:33:17.172 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:33:17.234 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 57 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:33:17.668 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:33:17.676 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:33:17.676 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:33:17.728 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:33:17.729 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1174 ms
16 Feb 2024 - 16:33:17.815 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:33:17.855 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:33:17.880 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:33:18.053 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:33:18.070 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:33:18.199 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38929da
16 Feb 2024 - 16:33:18.200 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:33:19.110 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:33:19.246 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:33:19.403 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:33:19.678 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:33:20.045 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:33:20.285 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1b0db8b1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@74cf0dd9, org.springframework.security.web.context.SecurityContextHolderFilter@2c1523cd, org.springframework.security.web.header.HeaderWriterFilter@58c84be1, org.springframework.security.web.authentication.logout.LogoutFilter@12b79055, com.example.config.JwtTokenFilter@2ff4d61b, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@9eaaecf, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@29d578de, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3bb29351, org.springframework.security.web.access.ExceptionTranslationFilter@20c9b155, org.springframework.security.web.access.intercept.AuthorizationFilter@56e32a23]
16 Feb 2024 - 16:33:20.549 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:33:20.557 INFO  com.example.Application - Started Application in 4.349 seconds (process running for 4.734)
16 Feb 2024 - 16:33:20.600 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:33:20.600 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:33:20.600 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:33:20.611 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:33:20.615 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:33:20.639 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 16:33:20.646 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:33:20.654 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:33:20.668 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.007s)
16 Feb 2024 - 16:33:28.946 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 16:33:28.947 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 16:33:28.948 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
16 Feb 2024 - 16:33:29.031 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:33:37.569 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:33:37.624 WARN  c.example.service.ArticleLikeService -  remove like or dislike
16 Feb 2024 - 16:36:02.619 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:36:02.621 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:36:02.629 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:36:04.566 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 17136 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:36:04.573 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:36:04.574 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:36:05.212 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:36:05.265 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:36:05.655 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:36:05.662 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:36:05.662 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:36:05.707 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:36:05.707 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1100 ms
16 Feb 2024 - 16:36:05.778 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:36:05.811 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:36:05.833 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:36:06.014 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:36:06.036 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:36:06.151 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@789dd6bf
16 Feb 2024 - 16:36:06.152 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:36:07.056 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:36:07.190 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:36:07.338 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:36:07.628 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:36:08.009 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:36:08.253 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11caa21d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b0db8b1, org.springframework.security.web.context.SecurityContextHolderFilter@43dc6864, org.springframework.security.web.header.HeaderWriterFilter@154f5d37, org.springframework.security.web.authentication.logout.LogoutFilter@7d59e235, com.example.config.JwtTokenFilter@10f64bc3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3698f2ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9eaaecf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@74cf0dd9, org.springframework.security.web.access.ExceptionTranslationFilter@5a558335, org.springframework.security.web.access.intercept.AuthorizationFilter@67710b92]
16 Feb 2024 - 16:36:08.509 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:36:08.521 INFO  com.example.Application - Started Application in 4.274 seconds (process running for 4.676)
16 Feb 2024 - 16:36:08.563 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:36:08.563 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:36:08.563 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:36:08.573 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:36:08.577 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:36:08.603 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:36:08.613 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration checksum mismatch for migration version 5
-> Applied to database : 905965518
-> Resolved locally    : 104013897
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 16:36:08.626 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:36:08.627 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:36:08.633 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:36:18.046 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 1972 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:36:18.054 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:36:18.055 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:36:18.682 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:36:18.739 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 52 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:36:19.140 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:36:19.147 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:36:19.147 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:36:19.192 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:36:19.193 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1107 ms
16 Feb 2024 - 16:36:19.269 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:36:19.304 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:36:19.326 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:36:19.511 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:36:19.531 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:36:19.649 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@213012a0
16 Feb 2024 - 16:36:19.650 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:36:20.589 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:36:20.714 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:36:20.892 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:36:21.149 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:36:21.531 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:36:21.775 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6a2cd5ea, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1c68601b, org.springframework.security.web.context.SecurityContextHolderFilter@59e7a6d8, org.springframework.security.web.header.HeaderWriterFilter@44bd11a2, org.springframework.security.web.authentication.logout.LogoutFilter@78f3ce56, com.example.config.JwtTokenFilter@2a2cdba0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@69503026, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7959d16a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3128be29, org.springframework.security.web.access.ExceptionTranslationFilter@341f2f4c, org.springframework.security.web.access.intercept.AuthorizationFilter@6329d89f]
16 Feb 2024 - 16:36:22.039 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:36:22.046 INFO  com.example.Application - Started Application in 4.334 seconds (process running for 4.757)
16 Feb 2024 - 16:36:22.094 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:36:22.094 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:36:22.094 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:36:22.104 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:36:22.107 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:36:22.130 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 16:36:22.138 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 5
16 Feb 2024 - 16:36:22.141 INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
16 Feb 2024 - 16:36:35.215 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 16:36:35.215 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 16:36:35.216 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
16 Feb 2024 - 16:36:35.297 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:36:40.130 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:36:40.170 WARN  c.example.service.ArticleLikeService -  remove like or dislike
16 Feb 2024 - 16:39:18.501 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:39:18.503 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:39:18.514 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:39:20.239 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 14892 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:39:20.247 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:39:20.248 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:39:20.923 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:39:20.984 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:39:21.387 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:39:21.393 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:39:21.394 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:39:21.445 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:39:21.445 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1161 ms
16 Feb 2024 - 16:39:21.522 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:39:21.557 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:39:21.579 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:39:21.756 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:39:21.775 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:39:21.893 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38929da
16 Feb 2024 - 16:39:21.895 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:39:22.820 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:39:22.950 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:39:23.127 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:39:23.389 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:39:23.763 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:39:24.007 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1b0db8b1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@74cf0dd9, org.springframework.security.web.context.SecurityContextHolderFilter@2c1523cd, org.springframework.security.web.header.HeaderWriterFilter@58c84be1, org.springframework.security.web.authentication.logout.LogoutFilter@12b79055, com.example.config.JwtTokenFilter@2ff4d61b, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@9eaaecf, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@29d578de, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3bb29351, org.springframework.security.web.access.ExceptionTranslationFilter@20c9b155, org.springframework.security.web.access.intercept.AuthorizationFilter@56e32a23]
16 Feb 2024 - 16:39:24.276 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:39:24.286 INFO  com.example.Application - Started Application in 4.35 seconds (process running for 4.744)
16 Feb 2024 - 16:39:24.327 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:39:24.328 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:39:24.328 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:39:24.338 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:39:24.342 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:39:24.365 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 16:39:24.372 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:39:24.380 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - likeTrigger"
16 Feb 2024 - 16:39:24.398 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.011s)
16 Feb 2024 - 16:41:00.372 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:41:00.375 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:41:00.381 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:42:09.774 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 21268 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:42:09.787 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:42:09.788 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:42:10.663 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:42:10.720 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:42:11.240 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:42:11.252 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:42:11.252 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:42:11.316 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:42:11.317 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1448 ms
16 Feb 2024 - 16:42:11.435 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:42:11.503 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:42:11.542 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:42:11.765 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:42:11.784 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:42:11.918 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@70c205bf
16 Feb 2024 - 16:42:11.920 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:42:13.024 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:42:13.178 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:42:13.350 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:42:13.602 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:42:13.966 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:42:14.297 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7ec02149, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2afdab87, org.springframework.security.web.context.SecurityContextHolderFilter@490f4b14, org.springframework.security.web.header.HeaderWriterFilter@65daaa95, org.springframework.security.web.authentication.logout.LogoutFilter@5decbb5f, com.example.config.JwtTokenFilter@6d0d5147, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4b9be679, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@45e97963, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@70903e7b, org.springframework.security.web.access.ExceptionTranslationFilter@6291d30, org.springframework.security.web.access.intercept.AuthorizationFilter@260f8704]
16 Feb 2024 - 16:42:14.680 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:42:14.689 INFO  com.example.Application - Started Application in 5.322 seconds (process running for 6.327)
16 Feb 2024 - 16:42:14.750 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:42:14.750 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:42:14.750 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:42:14.758 INFO  o.f.c.i.r.ResourceNameValidator - 1 SQL migrations were detected but not run because they did not follow the filename convention.
16 Feb 2024 - 16:42:14.759 INFO  o.f.c.i.r.ResourceNameValidator - Set 'validateMigrationNaming' to true to fail fast and see a list of the invalid file names.
16 Feb 2024 - 16:42:14.764 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:42:14.769 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:42:14.797 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.020s)
16 Feb 2024 - 16:42:14.805 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 5
16 Feb 2024 - 16:42:14.805 WARN  o.f.core.internal.command.DbMigrate - Schema "public" has a version (5) that is newer than the latest available migration (4) !
16 Feb 2024 - 16:42:14.807 INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
16 Feb 2024 - 16:42:19.799 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:42:19.801 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:42:19.803 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:42:21.475 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 15500 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:42:21.484 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:42:21.484 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:42:22.106 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:42:22.159 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:42:22.550 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:42:22.561 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:42:22.561 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:42:22.624 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:42:22.624 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1107 ms
16 Feb 2024 - 16:42:22.731 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:42:22.789 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:42:22.828 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:42:23.029 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:42:23.045 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:42:23.158 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3c544c9
16 Feb 2024 - 16:42:23.159 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:42:24.120 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:42:24.271 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:42:24.459 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:42:24.710 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:42:25.045 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:42:25.316 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3a792bf9, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@33093469, org.springframework.security.web.context.SecurityContextHolderFilter@341f2f4c, org.springframework.security.web.header.HeaderWriterFilter@25af233d, org.springframework.security.web.authentication.logout.LogoutFilter@b521697, com.example.config.JwtTokenFilter@1bad5ab3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@44bd11a2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@56595dcb, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4967fabe, org.springframework.security.web.access.ExceptionTranslationFilter@9d7d83d, org.springframework.security.web.access.intercept.AuthorizationFilter@62f30cea]
16 Feb 2024 - 16:42:25.677 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:42:25.686 INFO  com.example.Application - Started Application in 4.498 seconds (process running for 4.923)
16 Feb 2024 - 16:42:25.746 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:42:25.746 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:42:25.746 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:42:25.757 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:42:25.761 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:42:25.785 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 16:42:25.794 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration description mismatch for migration version 5
-> Applied to database : likeTrigger
-> Resolved locally    : init like
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 16:42:25.805 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:42:25.807 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:42:25.809 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 16:42:36.750 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 19428 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 16:42:36.757 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 16:42:36.758 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 16:42:37.375 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 16:42:37.421 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 42 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 16:42:37.784 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 16:42:37.790 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 16:42:37.790 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 16:42:37.831 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 16:42:37.832 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1046 ms
16 Feb 2024 - 16:42:37.901 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 16:42:37.932 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 16:42:37.951 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 16:42:38.151 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 16:42:38.168 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 16:42:38.276 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@175ac243
16 Feb 2024 - 16:42:38.277 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 16:42:39.255 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 16:42:39.395 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:42:39.592 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 16:42:39.865 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 16:42:40.188 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 16:42:40.421 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7d59e235, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@12b79055, org.springframework.security.web.context.SecurityContextHolderFilter@6b00587b, org.springframework.security.web.header.HeaderWriterFilter@1d6c69ff, org.springframework.security.web.authentication.logout.LogoutFilter@6329d89f, com.example.config.JwtTokenFilter@3a4e6da6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@476e4bb0, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@337fd6a1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1cc771ae, org.springframework.security.web.access.ExceptionTranslationFilter@69503026, org.springframework.security.web.access.intercept.AuthorizationFilter@12139db0]
16 Feb 2024 - 16:42:40.720 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 16:42:40.728 INFO  com.example.Application - Started Application in 4.244 seconds (process running for 4.593)
16 Feb 2024 - 16:42:40.788 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 16:42:40.788 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 16:42:40.788 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 16:42:40.800 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 16:42:40.805 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 16:42:40.831 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.018s)
16 Feb 2024 - 16:42:40.839 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 16:42:40.846 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 16:42:40.867 INFO  o.f.core.internal.command.DbMigrate - Successfully applied 1 migration to schema "public", now at version v5 (execution time 00:00.014s)
16 Feb 2024 - 16:42:53.746 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 16:42:53.746 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 16:42:53.748 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
16 Feb 2024 - 16:42:53.863 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:42:56.040 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:43:01.568 INFO  c.e.controller.ArticleLikeController - Article like 2cf23946-008d-481e-8d80-75e92b389540
16 Feb 2024 - 16:43:01.637 WARN  c.example.service.ArticleLikeService -  remove like or dislike
16 Feb 2024 - 16:44:13.267 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 16:44:13.268 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 16:44:13.271 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 18:20:29.561 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 19320 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 18:20:29.570 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 18:20:29.570 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 18:20:30.222 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 18:20:30.335 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 105 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 18:20:30.778 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 18:20:30.787 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 18:20:30.787 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 18:20:30.835 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 18:20:30.835 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1229 ms
16 Feb 2024 - 18:20:30.912 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 18:20:30.949 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 18:20:30.974 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 18:20:31.167 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 18:20:31.185 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 18:20:31.314 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1073c664
16 Feb 2024 - 18:20:31.315 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 18:20:32.193 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 18:20:32.330 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 18:20:32.494 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 18:20:32.765 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 18:20:33.134 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 18:20:33.381 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@f6b85c3, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3d118651, org.springframework.security.web.context.SecurityContextHolderFilter@337fd6a1, org.springframework.security.web.header.HeaderWriterFilter@6b00587b, org.springframework.security.web.authentication.logout.LogoutFilter@1c68601b, com.example.config.JwtTokenFilter@70eced1f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@20c9b155, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@154f5d37, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@138a8c9e, org.springframework.security.web.access.ExceptionTranslationFilter@34dcd7a1, org.springframework.security.web.access.intercept.AuthorizationFilter@12b79055]
16 Feb 2024 - 18:20:33.659 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 18:20:33.668 INFO  com.example.Application - Started Application in 4.424 seconds (process running for 4.888)
16 Feb 2024 - 18:20:33.722 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 18:20:33.722 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 18:20:33.722 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 18:20:33.732 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 18:20:33.736 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 18:20:33.757 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.015s)
16 Feb 2024 - 18:20:33.764 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 5
16 Feb 2024 - 18:20:33.765 INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
16 Feb 2024 - 18:20:35.360 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16 Feb 2024 - 18:20:35.361 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16 Feb 2024 - 18:20:35.362 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
16 Feb 2024 - 18:20:35.468 INFO  c.example.controller.AuthController - Login uchanal10@gmail.com 
16 Feb 2024 - 18:21:06.944 INFO  c.example.controller.AuthController - Login uchanal10@gmail.com 
16 Feb 2024 - 18:21:32.210 INFO  c.e.controller.ProfileController - Created profile edD@gmail.comModer
16 Feb 2024 - 18:24:26.875 INFO  c.example.controller.AuthController - Login edD@gmail.com 
16 Feb 2024 - 18:24:31.247 INFO  c.example.controller.AuthController - Login edD@gmail.com 
16 Feb 2024 - 18:24:40.175 INFO  c.example.controller.AuthController - Login edD@gmail.com 
16 Feb 2024 - 19:13:06.272 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:13:06.276 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:13:06.285 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:13:09.896 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 14304 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:13:09.906 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:13:09.907 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:13:10.603 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:13:10.660 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 52 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:13:11.142 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:13:11.150 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:13:11.150 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:13:11.198 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:13:11.199 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1253 ms
16 Feb 2024 - 19:13:11.291 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:13:11.327 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:13:11.358 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:13:11.541 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:13:11.569 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:13:11.716 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@789dd6bf
16 Feb 2024 - 19:13:11.717 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:13:12.638 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:13:12.777 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:13:12.957 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:13:13.282 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:13:13.670 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:13:13.912 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11caa21d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b0db8b1, org.springframework.security.web.context.SecurityContextHolderFilter@43dc6864, org.springframework.security.web.header.HeaderWriterFilter@154f5d37, org.springframework.security.web.authentication.logout.LogoutFilter@7d59e235, com.example.config.JwtTokenFilter@10f64bc3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3698f2ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9eaaecf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@74cf0dd9, org.springframework.security.web.access.ExceptionTranslationFilter@5a558335, org.springframework.security.web.access.intercept.AuthorizationFilter@67710b92]
16 Feb 2024 - 19:13:14.185 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:13:14.195 INFO  com.example.Application - Started Application in 4.624 seconds (process running for 5.024)
16 Feb 2024 - 19:13:14.242 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:13:14.242 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:13:14.242 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:13:14.252 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:13:14.256 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:13:14.281 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:13:14.292 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.api.exception.FlywayValidateException: Validate failed: Migrations have failed validation
Migration checksum mismatch for migration version 5
-> Applied to database : 905965518
-> Resolved locally    : 26899603
Either revert the changes to the migration, or run repair to update the schema history.
Need more flexibility with validation rules? Learn more: https://rd.gt/3AbJUZE
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:146)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
16 Feb 2024 - 19:13:14.305 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:13:14.306 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:13:14.316 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:14:18.183 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 21288 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:14:18.193 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:14:18.193 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:14:18.813 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:14:18.876 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:14:19.268 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:14:19.268 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:14:19.268 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:14:19.316 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:14:19.316 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1090 ms
16 Feb 2024 - 19:14:19.394 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:14:19.426 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:14:19.442 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:14:19.599 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:14:19.631 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:14:19.741 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@789dd6bf
16 Feb 2024 - 19:14:19.741 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:14:20.630 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:14:20.770 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:14:20.934 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:14:21.286 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:14:21.687 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:14:21.924 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1b0db8b1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@74cf0dd9, org.springframework.security.web.context.SecurityContextHolderFilter@2c1523cd, org.springframework.security.web.header.HeaderWriterFilter@58c84be1, org.springframework.security.web.authentication.logout.LogoutFilter@12b79055, com.example.config.JwtTokenFilter@10f64bc3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@9eaaecf, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@29d578de, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3bb29351, org.springframework.security.web.access.ExceptionTranslationFilter@20c9b155, org.springframework.security.web.access.intercept.AuthorizationFilter@56e32a23]
16 Feb 2024 - 19:14:22.220 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:14:22.229 INFO  com.example.Application - Started Application in 4.342 seconds (process running for 4.765)
16 Feb 2024 - 19:14:22.290 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:14:22.291 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:14:22.291 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:14:22.302 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:14:22.307 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:14:22.330 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.018s)
16 Feb 2024 - 19:14:22.346 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 19:14:22.356 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 19:14:22.378 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - init like" failed! Changes successfully rolled back.
16 Feb 2024 - 19:14:22.382 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:14:22.397 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1089
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 2
Statement  : CREATE OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2 set like_count = like_count + 1 where id = NEW.article_id;
elseif NEW.STATUS = 'DIS_LIKE' then
update article2 set dislike_count = dislike_count + 1 where id = NEW.article_id;
end if;
	ELSEIF TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DIS_LIKE' then
update article2 set like_count = like_count + 1, dislike_count = dislike_count - 1  where id = NEW.article_id;
elseif NEW.STATUS = 'DIS_LIKE' and OLD.status = 'LIKE' then
update article2 set like_count = like_count - 1, dislike_count = dislike_count + 1  where id = NEW.article_id;
end if;
	ELSEIF TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2 set like_count = like_count - 1 where id = OLD.article_id;
elseif OLD.STATUS = 'DIS_LIKE' then
update article2 set dislike_count = dislike_count - 1  where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$


   CREATE or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR UPDATE OR DELETE
                     ON article_like
                         FOR EACH ROW
                         EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1089
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 2
Statement  : CREATE OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2 set like_count = like_count + 1 where id = NEW.article_id;
elseif NEW.STATUS = 'DIS_LIKE' then
update article2 set dislike_count = dislike_count + 1 where id = NEW.article_id;
end if;
	ELSEIF TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DIS_LIKE' then
update article2 set like_count = like_count + 1, dislike_count = dislike_count - 1  where id = NEW.article_id;
elseif NEW.STATUS = 'DIS_LIKE' and OLD.status = 'LIKE' then
update article2 set like_count = like_count - 1, dislike_count = dislike_count + 1  where id = NEW.article_id;
end if;
	ELSEIF TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2 set like_count = like_count - 1 where id = OLD.article_id;
elseif OLD.STATUS = 'DIS_LIKE' then
update article2 set dislike_count = dislike_count - 1  where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$


   CREATE or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR UPDATE OR DELETE
                     ON article_like
                         FOR EACH ROW
                         EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1089
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 19:14:22.413 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:14:22.415 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:14:22.417 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:15:53.398 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 18672 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:15:53.407 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:15:53.408 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:15:54.061 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:15:54.115 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:15:54.556 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:15:54.564 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:15:54.564 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:15:54.615 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:15:54.623 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1179 ms
16 Feb 2024 - 19:15:54.698 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:15:54.731 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:15:54.758 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:15:54.928 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:15:54.945 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:15:55.069 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@48106381
16 Feb 2024 - 19:15:55.069 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:15:56.030 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:15:56.176 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:15:56.320 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:15:56.617 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:15:57.000 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:15:57.282 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5c1ecf52, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3a792bf9, org.springframework.security.web.context.SecurityContextHolderFilter@3464d24c, org.springframework.security.web.header.HeaderWriterFilter@7bff608c, org.springframework.security.web.authentication.logout.LogoutFilter@63031e98, com.example.config.JwtTokenFilter@4dbeae45, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@68754439, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@44bd11a2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@33093469, org.springframework.security.web.access.ExceptionTranslationFilter@9b5ff2e, org.springframework.security.web.access.intercept.AuthorizationFilter@2df491be]
16 Feb 2024 - 19:15:57.584 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:15:57.592 INFO  com.example.Application - Started Application in 4.544 seconds (process running for 4.937)
16 Feb 2024 - 19:15:57.634 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:15:57.634 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:15:57.634 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:15:57.643 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:15:57.650 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:15:57.667 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.018s)
16 Feb 2024 - 19:15:57.675 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 19:15:57.692 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 19:15:57.700 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - init like" failed! Changes successfully rolled back.
16 Feb 2024 - 19:15:57.700 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:15:57.708 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1119
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DIS_LIKE' then
update article2
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DIS_LIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DIS_LIKE' and OLD.status = 'LIKE' then
update article2
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DIS_LIKE' then
update article2
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1119
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DIS_LIKE' then
update article2
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DIS_LIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DIS_LIKE' and OLD.status = 'LIKE' then
update article2
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DIS_LIKE' then
update article2
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1119
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 19:15:57.725 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:15:57.725 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:15:57.733 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:16:25.177 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 1848 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:16:25.186 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:16:25.186 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:16:25.816 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:16:25.870 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:16:26.257 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:16:26.264 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:16:26.265 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:16:26.309 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:16:26.310 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1092 ms
16 Feb 2024 - 19:16:26.386 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:16:26.420 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:16:26.441 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:16:26.617 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:16:26.635 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:16:26.752 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@48106381
16 Feb 2024 - 19:16:26.753 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:16:27.655 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:16:27.784 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:16:27.931 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:16:28.207 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:16:28.569 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:16:28.814 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3a792bf9, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@33093469, org.springframework.security.web.context.SecurityContextHolderFilter@341f2f4c, org.springframework.security.web.header.HeaderWriterFilter@25af233d, org.springframework.security.web.authentication.logout.LogoutFilter@b521697, com.example.config.JwtTokenFilter@4dbeae45, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@44bd11a2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@56595dcb, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4967fabe, org.springframework.security.web.access.ExceptionTranslationFilter@9d7d83d, org.springframework.security.web.access.intercept.AuthorizationFilter@62f30cea]
16 Feb 2024 - 19:16:29.074 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:16:29.082 INFO  com.example.Application - Started Application in 4.212 seconds (process running for 4.6)
16 Feb 2024 - 19:16:29.122 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:16:29.123 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:16:29.123 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:16:29.133 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:16:29.137 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:16:29.158 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.015s)
16 Feb 2024 - 19:16:29.165 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 19:16:29.172 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 19:16:29.180 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - init like" failed! Changes successfully rolled back.
16 Feb 2024 - 19:16:29.183 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:16:29.194 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1115
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article2
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article2
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article2
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1115
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article2
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article2
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article2
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article2
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article2
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1115
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 19:16:29.209 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:16:29.210 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:16:29.216 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:17:23.731 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 5632 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:17:23.740 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:17:23.740 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:17:24.382 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:17:24.436 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:17:24.831 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:17:24.837 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:17:24.838 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:17:24.890 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:17:24.891 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1119 ms
16 Feb 2024 - 19:17:24.968 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:17:25.003 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:17:25.024 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:17:25.197 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:17:25.214 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:17:25.330 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@789dd6bf
16 Feb 2024 - 19:17:25.331 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:17:26.255 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:17:26.381 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:17:26.534 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:17:26.808 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:17:27.176 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:17:27.422 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@11caa21d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b0db8b1, org.springframework.security.web.context.SecurityContextHolderFilter@43dc6864, org.springframework.security.web.header.HeaderWriterFilter@154f5d37, org.springframework.security.web.authentication.logout.LogoutFilter@7d59e235, com.example.config.JwtTokenFilter@10f64bc3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3698f2ed, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@9eaaecf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@74cf0dd9, org.springframework.security.web.access.ExceptionTranslationFilter@5a558335, org.springframework.security.web.access.intercept.AuthorizationFilter@67710b92]
16 Feb 2024 - 19:17:27.692 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:17:27.699 INFO  com.example.Application - Started Application in 4.251 seconds (process running for 4.629)
16 Feb 2024 - 19:17:27.741 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:17:27.742 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:17:27.742 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:17:27.752 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:17:27.757 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:17:27.779 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.017s)
16 Feb 2024 - 19:17:27.787 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 19:17:27.798 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 19:17:27.806 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - init like" failed! Changes successfully rolled back.
16 Feb 2024 - 19:17:27.810 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:17:27.821 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1110
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1110
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article2
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1110
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 19:17:27.836 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:17:27.837 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:17:27.844 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
16 Feb 2024 - 19:18:08.114 INFO  com.example.Application - Starting Application using Java 17.0.9 with PID 13976 (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes started by javox in C:\Users\javox\IdeaProjects\kun.uz_lesson1)
16 Feb 2024 - 19:18:08.122 DEBUG com.example.Application - Running with Spring Boot v3.2.2, Spring v6.1.3
16 Feb 2024 - 19:18:08.123 INFO  com.example.Application - No active profile set, falling back to 1 default profile: "default"
16 Feb 2024 - 19:18:08.813 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
16 Feb 2024 - 19:18:08.867 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 11 JPA repository interfaces.
16 Feb 2024 - 19:18:09.270 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16 Feb 2024 - 19:18:09.277 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16 Feb 2024 - 19:18:09.278 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.18]
16 Feb 2024 - 19:18:09.328 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16 Feb 2024 - 19:18:09.329 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1172 ms
16 Feb 2024 - 19:18:09.405 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
16 Feb 2024 - 19:18:09.438 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
16 Feb 2024 - 19:18:09.460 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
16 Feb 2024 - 19:18:09.635 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
16 Feb 2024 - 19:18:09.653 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
16 Feb 2024 - 19:18:09.769 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38929da
16 Feb 2024 - 19:18:09.770 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
16 Feb 2024 - 19:18:10.685 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
16 Feb 2024 - 19:18:10.820 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:18:10.974 INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
16 Feb 2024 - 19:18:11.249 DEBUG com.example.config.JwtTokenFilter - Filter 'jwtTokenFilter' configured for use
16 Feb 2024 - 19:18:11.618 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
16 Feb 2024 - 19:18:11.924 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@74cf0dd9, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3bb29351, org.springframework.security.web.context.SecurityContextHolderFilter@3698f2ed, org.springframework.security.web.header.HeaderWriterFilter@2e7227e6, org.springframework.security.web.authentication.logout.LogoutFilter@1cc771ae, com.example.config.JwtTokenFilter@2ff4d61b, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@29d578de, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2c5b2d62, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7f2c0470, org.springframework.security.web.access.ExceptionTranslationFilter@154f5d37, org.springframework.security.web.access.intercept.AuthorizationFilter@11caa21d]
16 Feb 2024 - 19:18:12.271 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16 Feb 2024 - 19:18:12.279 INFO  com.example.Application - Started Application in 4.477 seconds (process running for 4.863)
16 Feb 2024 - 19:18:12.321 INFO  o.f.c.i.license.VersionPrinter - Flyway Community Edition 9.22.3 by Redgate
16 Feb 2024 - 19:18:12.321 INFO  o.f.c.i.license.VersionPrinter - See release notes here: https://rd.gt/416ObMi
16 Feb 2024 - 19:18:12.321 INFO  o.f.c.i.license.VersionPrinter - 
16 Feb 2024 - 19:18:12.332 INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/kun.uz (PostgreSQL 16.1)
16 Feb 2024 - 19:18:12.338 WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 16.1 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
16 Feb 2024 - 19:18:12.363 INFO  o.f.core.internal.command.DbValidate - Successfully validated 6 migrations (execution time 00:00.018s)
16 Feb 2024 - 19:18:12.371 INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 4
16 Feb 2024 - 19:18:12.380 INFO  o.f.core.internal.command.DbMigrate - Migrating schema "public" to version "5 - init like"
16 Feb 2024 - 19:18:12.387 ERROR o.f.core.internal.command.DbMigrate - Migration of schema "public" to version "5 - init like" failed! Changes successfully rolled back.
16 Feb 2024 - 19:18:12.391 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
16 Feb 2024 - 19:18:12.403 ERROR o.s.boot.SpringApplication - Application run failed
org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1109
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:73)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.lambda$execute$0(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLAdvisoryLockTemplate.execute(PostgreSQLAdvisoryLockTemplate.java:56)
	at org.flywaydb.core.internal.database.postgresql.PostgreSQLConnection.lock(PostgreSQLConnection.java:96)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:144)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:188)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:213)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:140)
	at com.example.service.CommandLineAppStartupRunner.run(CommandLineAppStartupRunner.java:18)
	at org.springframework.boot.SpringApplication.lambda$callRunner$5(SpringApplication.java:790)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:83)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:88)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:798)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:789)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:774)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:774)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:341)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343)
	at com.example.Application.main(Application.java:10)
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V5__init_like.sql failed
----------------------------------
SQL State  : 42601
Error Code : 0
Message    : ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1109
Location   : db/migration/V5__init_like.sql (C:\Users\javox\IdeaProjects\kun.uz_lesson1\target\classes\db\migration\V5__init_like.sql)
Line       : 1
Statement  : CREATE
OR REPLACE FUNCTION article_like_trigger_function()
RETURNS TRIGGER
LANGUAGE PLPGSQL
AS $$
BEGIN
--NEW OLD
    IF
TG_OP = 'INSERT' then
		IF NEW.status = 'LIKE' then
update article
set like_count = like_count + 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'UPDATE'then
		 IF NEW.status = 'LIKE' and OLD.status = 'DISLIKE' then
update article
set like_count    = like_count + 1,
    dislike_count = dislike_count - 1
where id = NEW.article_id;
elseif
NEW.STATUS = 'DISLIKE' and OLD.status = 'LIKE' then
update article
set like_count    = like_count - 1,
    dislike_count = dislike_count + 1
where id = NEW.article_id;
end if;
	ELSEIF
TG_OP = 'DELETE' then
		 IF OLD.status = 'LIKE' then
update article
set like_count = like_count - 1
where id = OLD.article_id;
elseif
OLD.STATUS = 'DISLIKE' then
update article
set dislike_count = dislike_count - 1
where id = OLD.article_id;
end if;
return OLD;
end if;
return NEW;
END; $$

   CREATE
or REPLACE TRIGGER article_like_trigger
	BEFORE INSERT OR
UPDATE OR
DELETE
ON article_like
    FOR EACH ROW
    EXECUTE PROCEDURE article_like_trigger_function()

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:267)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:222)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:126)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:68)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 37 common frames omitted
Caused by: org.postgresql.util.PSQLException: ОШИБКА: ошибка синтаксиса (примерное положение: "CREATE")
  Position: 1109
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:335)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:321)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:297)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:292)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:201)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:95)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:210)
	... 43 common frames omitted
16 Feb 2024 - 19:18:12.422 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
16 Feb 2024 - 19:18:12.423 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
16 Feb 2024 - 19:18:12.427 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
